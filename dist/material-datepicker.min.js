"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),MaterialDatepicker=function(){function a(b,c){_classCallCheck(this,a);var d={type:"date",lang:"en",orientation:"landscape",color:"rgba(0, 150, 136, 1)",theme:"light",zIndex:"100",buttons:!0,openOn:"click",closeAfterClick:!0,date:new Date,weekBegin:"sunday",outputFormat:{date:"YYYY/MM/DD",month:"MMMM YYYY"},topHeaderFormat:"YYYY",headerFormat:{date:"ddd, MMM D",month:"MMM"},sitePickerFormat:{date:"MMMM YYYY",month:"YYYY"},onLoad:"",onOpen:"",onNewDate:"",outputElement:""};if(this.settings=Object.assign(d,c),moment.locale(this.settings.lang),"object"==typeof this.settings.topHeaderFormat&&(this.settings.topHeaderFormat=this.settings.topHeaderFormat[this.settings.type]),"object"==typeof this.settings.headerFormat&&(this.settings.headerFormat=this.settings.headerFormat[this.settings.type]),"object"==typeof this.settings.outputFormat&&(this.settings.outputFormat=this.settings.outputFormat[this.settings.type]),"object"==typeof this.settings.sitePickerFormat&&(this.settings.sitePickerFormat=this.settings.sitePickerFormat[this.settings.type]),this.element=b,"string"==typeof this.element&&(this.element=document.querySelector(""+b),null==this.element))return void console.warn('Material Datepicker could not initialize because, Object: "'+b+'" is not defined');var e=this.element.tagName,f=this.element.getAttribute("type"),g=this.element.value;("INPUT"!=e||"date"!=f&&"number"!=f&&"text"!=f)&&"PAPER-INPUT"!=e||""==g?this.date=this.settings.date:this.date=moment(g,this.settings.outputFormat).toDate(),"string"==typeof this.settings.outputElement&&""!=this.settings.outputElement&&(this.settings.outputElement=document.querySelector(""+this.settings.outputElement)),this._define()}return _createClass(a,[{key:"_define",value:function(){var a=this;return this._createElement(),"direct"==this.settings.openOn?void this.open(this.settings.openOn):void this.element.addEventListener(this.settings.openOn,function(){a.open(a.settings.openOn)})}},{key:"_createElement",value:function(a){var b=this,c=(new Date).getTime()+Math.round(Math.random()+2);this.picker=document.createElement("div"),this.picker.setAttribute("class","mp-"+this.settings.type+"picker mp-picker"),this.picker.setAttribute("id","mp-"+c),this.picker.setAttribute("data-theme",this.settings.theme);var d=document.createElement("div");d.setAttribute("class","mp-picker-info"),this.picker.appendChild(d);var e=document.createElement("div");e.setAttribute("class","mp-picker-picker"),this.picker.appendChild(e);var f=document.createElement("span");f.setAttribute("class","mp-info-first"),d.appendChild(f);var g=document.createElement("span");g.setAttribute("class","mp-info-second"),d.appendChild(g);var h=document.createElement("div");h.setAttribute("class","mp-picker-site"),e.appendChild(h);var i=document.createElement("a");i.setAttribute("class","mp-picker-site-before mp-picker-site-button"),h.appendChild(i),i.addEventListener("click",function(){b._siteChange(-1)});var j=document.createElement("span");j.setAttribute("class","mp-picker-site-this mp-animate"),h.appendChild(j);var k=document.createElement("a");k.setAttribute("class","mp-picker-site-next mp-picker-site-button"),h.appendChild(k),k.addEventListener("click",function(){b._siteChange(1)});var l=document.createElement("div");l.setAttribute("class","mp-picker-choose mp-animate"),e.appendChild(l);var m="\n      #mp-"+c+'.mp-picker:not([data-theme="dark"]) .mp-picker-info {\n        background-color: '+this.settings.color+";\n      }\n\n      #mp-"+c+'.mp-picker .mp-picker-choose [class*="mp-picker-click"].active,\n      #mp-'+c+'.mp-picker[data-theme="dark"] .mp-picker-choose [class*="mp-picker-click"].active {\n        background-color: '+this.settings.color+";\n      }\n\n      #mp-"+c+'.mp-picker .mp-picker-choose [class*="mp-picker-click"].today:not(.active),\n      #mp-'+c+'.mp-picker[data-theme="dark"] .mp-picker-choose .mp-picker-choose [class*="mp-picker-click"].today:not(.active) {\n        color: '+this.settings.color+";\n      }\n    ",n=document.createElement("style");n.type="text/css",n.appendChild(document.createTextNode(m)),document.querySelector("head").appendChild(n),this._updatePicker()}},{key:"_updatePicker",value:function(){var a=this,b=this.picker.querySelector(".mp-picker-choose");if(b.innerHTML="","date"==this.settings.type){for(var c=42,d=7,e=0;d>e;e++){var f=e;"monday"==this.settings.weekBegin&&(f+=1,f>=d&&(f=0));var g=document.createElement("span");g.setAttribute("class","mp-picker-header mp-picker-header-day-"+e),g.innerHTML=moment.weekdaysMin()[f].substr(0,1),b.appendChild(g)}var h=this.date.getTime();h=new Date(h),h.setDate(1),h.setMonth(h.getMonth()+1),h.setDate(0);var i=h;h=h.getDate(),i.setDate(1),i=i.getDay();for(var j=function(c,d){var e=document.createElement("a");e.setAttribute("class","mp-picker-choose-day");var f=c>=i;"monday"==a.settings.weekBegin&&(f=c+1>=i),f&&h>=d?(e.innerHTML=d,e.classList.add("mp-picker-click-"+d),d++):(e.innerHTML=" ",e.classList.add("mp-empty")),b.appendChild(e),e.addEventListener("click",function(b){if(!b.path[0].classList.contains("mp-empty")){var c=d-1,e=a.date;e.setDate(c),"direct"==a.settings.openOn?a.newDate(e):a.newDate(e,"close")}}),k=d},e=0,k=1;c>e;e++)j(e,k)}else if("month"==this.settings.type)for(var l=12,m=function(c){var d=document.createElement("a");d.setAttribute("class","mp-picker-click-"+c+" mp-picker-choose-month"),d.innerHTML=moment.monthsShort("-MMM-")[c],b.appendChild(d),d.addEventListener("click",function(){var b=c,d=a.date;d.setMonth(b),a.newDate(d,"close")})},e=0;l>e;e++)m(e);this.callbackOnLoad()}},{key:"_siteChange",value:function(a){var b=this,c={"-1":"left",1:"right"},d={"-1":"right",1:"left"};"date"==this.settings.type?this.date.setMonth(this.date.getMonth()+a):"month"==this.settings.type&&this.date.setYear(this.date.getYear()+1900+a),this.picker.querySelectorAll(".mp-animate")[0].classList.add("mp-animate-"+c[a]),this.picker.querySelectorAll(".mp-animate")[1].classList.add("mp-animate-"+c[a]),setTimeout(function(){b.picker.querySelectorAll(".mp-animate")[0].classList.remove("mp-animate-"+c[a]),b.picker.querySelectorAll(".mp-animate")[0].classList.add("mp-animate-"+d[a]),b.picker.querySelectorAll(".mp-animate")[1].classList.remove("mp-animate-"+c[a]),b.picker.querySelectorAll(".mp-animate")[1].classList.add("mp-animate-"+d[a]),b._updatePicker(),setTimeout(function(){b.picker.querySelectorAll(".mp-animate")[0].classList.remove("mp-animate-"+d[a]),b.picker.querySelectorAll(".mp-animate")[1].classList.remove("mp-animate-"+d[a]),b.newDate(b.date)},200)},200)}},{key:"open",value:function(a){if("direct"==a&&"DIV"==this.element.tagName)return this.element.appendChild(this.picker),this.newDate(null),void this.callbackOnOpen();var b=this.element.tagName,c=this.element.getAttribute("type"),d=this.element.value;("INPUT"!=b||"date"!=c&&"number"!=c&&"text"!=c)&&"PAPER-INPUT"!=b||""==d||(this.date=moment(d,this.settings.outputFormat).toDate()),document.body.appendChild(this.picker);var e=this.element.getBoundingClientRect(),f=e.top+e.height+5,g=e.left,h=document.body.getBoundingClientRect(),i=this.picker.getBoundingClientRect();g+i.width+50>h.width&&(g=g-i.width-5),f+i.height+20>h.height&&(f=f-i.height-e.height-5),this.picker.style.top=f,this.picker.style.left=g,this.picker.style.zIndex=this.settings.zIndex,this.newDate(null),this.callbackOnOpen()}},{key:"close",value:function(){this.picker&&this.picker.parentNode&&this.picker.parentNode.removeChild(this.picker)}},{key:"newDate",value:function(a,b){var c=a||this.date;this.picker.querySelector(".mp-info-first").innerHTML=moment(c).format(this.settings.topHeaderFormat),this.picker.querySelector(".mp-info-second").innerHTML=moment(c).format(this.settings.headerFormat),this.picker.querySelector(".mp-picker-site-this").innerHTML=moment(c).format(this.settings.sitePickerFormat),null!=this.picker.querySelector('[class*="mp-picker-click"].active')&&this.picker.querySelector('[class*="mp-picker-click"].active').classList.remove("active"),"date"==this.settings.type?((new Date).getYear()==c.getYear()&&(new Date).getMonth()==c.getMonth()?this.picker.querySelector(".mp-picker-click-"+1*(new Date).getDate()).classList.add("today"):null!=this.picker.querySelector(".mp-picker-click-"+1*(new Date).getMonth()+".today")&&this.picker.querySelector(".mp-picker-click-"+1*(new Date).getDate()+".today").classList.remove("today"),this.picker.querySelector(".mp-picker-click-"+1*c.getDate()).classList.add("active")):"month"==this.settings.type&&((new Date).getYear()==c.getYear()?this.picker.querySelector(".mp-picker-click-"+1*(new Date).getMonth()).classList.add("today"):null!=this.picker.querySelector(".mp-picker-click-"+1*(new Date).getMonth()+".today")&&this.picker.querySelector(".mp-picker-click-"+1*(new Date).getMonth()+".today").classList.remove("today"),this.picker.querySelector(".mp-picker-click-"+1*c.getMonth()).classList.add("active")),c.setMilliseconds(0),c.setSeconds(0),c.setMinutes(0),c.setHours(0),this.date=c;var d=moment(c).format(this.settings.outputFormat);("INPUT"==this.element.tagName&&"text"==this.element.getAttribute("type")||"DIV"==this.element.tagName||"PAPER-INPUT"==this.element.tagName)&&(this.element.value=d),("SPAN"==this.settings.outputElement.tagName||"P"==this.settings.outputElement.tagName||"A"==this.settings.outputElement.tagName)&&(this.settings.outputElement.innerHTML=d),"close"==b&&(this.close(),this.callbackOnNewDate())}},{key:"callbackOnLoad",value:function(){"function"==typeof this.settings.onLoad&&this.settings.onLoad.call(this,this.date)}},{key:"callbackOnOpen",value:function(){"function"==typeof this.settings.onOpen&&this.settings.onOpen.call(this,this.date)}},{key:"callbackOnNewDate",value:function(){"function"==typeof this.settings.onNewDate&&this.settings.onNewDate.call(this,this.date)}}]),a}();